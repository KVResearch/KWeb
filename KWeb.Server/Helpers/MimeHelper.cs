using System.Collections.Concurrent;
using System.Collections.Generic;

namespace KWeb.Server.Helpers
{
    public class MimeHelper
    {
        // See more
        // https://referencesource.microsoft.com/#system.web/MimeMapping.cs,101
        public static string GetContentType(string extension)
        {
            if (!extension.StartsWith("."))
                extension = "." + extension;
            if (_dic.ContainsKey(extension))
                return _dic[extension];
            return "application/octet-stream";
        }

        private static readonly ConcurrentDictionary<string, string> _dic = new ConcurrentDictionary<string, string>(
            new List<KeyValuePair<string, string>>
            {
                new(".323", "text/h323"),
                new(".aaf", "application/octet-stream"),
                new(".aca", "application/octet-stream"),
                new(".accdb", "application/msaccess"),
                new(".accde", "application/msaccess"),
                new(".accdt", "application/msaccess"),
                new(".acx", "application/internet-property-stream"),
                new(".afm", "application/octet-stream"),
                new(".ai", "application/postscript"),
                new(".aif", "audio/x-aiff"),
                new(".aifc", "audio/aiff"),
                new(".aiff", "audio/aiff"),
                new(".application", "application/x-ms-application"),
                new(".art", "image/x-jg"),
                new(".asd", "application/octet-stream"),
                new(".asf", "video/x-ms-asf"),
                new(".asi", "application/octet-stream"),
                new(".asm", "text/plain"),
                new(".asr", "video/x-ms-asf"),
                new(".asx", "video/x-ms-asf"),
                new(".atom", "application/atom+xml"),
                new(".au", "audio/basic"),
                new(".avi", "video/x-msvideo"),
                new(".axs", "application/olescript"),
                new(".bas", "text/plain"),
                new(".bcpio", "application/x-bcpio"),
                new(".bin", "application/octet-stream"),
                new(".bmp", "image/bmp"),
                new(".c", "text/plain"),
                new(".cab", "application/octet-stream"),
                new(".calx", "application/vnd.ms-office.calx"),
                new(".cat", "application/vnd.ms-pki.seccat"),
                new(".cdf", "application/x-cdf"),
                new(".chm", "application/octet-stream"),
                new(".class", "application/x-java-applet"),
                new(".clp", "application/x-msclip"),
                new(".cmx", "image/x-cmx"),
                new(".cnf", "text/plain"),
                new(".cod", "image/cis-cod"),
                new(".cpio", "application/x-cpio"),
                new(".cpp", "text/plain"),
                new(".crd", "application/x-mscardfile"),
                new(".crl", "application/pkix-crl"),
                new(".crt", "application/x-x509-ca-cert"),
                new(".csh", "application/x-csh"),
                new(".css", "text/css"),
                new(".csv", "application/octet-stream"),
                new(".cur", "application/octet-stream"),
                new(".dcr", "application/x-director"),
                new(".deploy", "application/octet-stream"),
                new(".der", "application/x-x509-ca-cert"),
                new(".dib", "image/bmp"),
                new(".dir", "application/x-director"),
                new(".disco", "text/xml"),
                new(".dll", "application/x-msdownload"),
                new(".dll.config", "text/xml"),
                new(".dlm", "text/dlm"),
                new(".doc", "application/msword"),
                new(".docm", "application/vnd.ms-word.document.macroEnabled.12"),
                new(".docx", "application/vnd.openxmlformats-officedocument.wordprocessingml.document"),
                new(".dot", "application/msword"),
                new(".dotm", "application/vnd.ms-word.template.macroEnabled.12"),
                new(".dotx", "application/vnd.openxmlformats-officedocument.wordprocessingml.template"),
                new(".dsp", "application/octet-stream"),
                new(".dtd", "text/xml"),
                new(".dvi", "application/x-dvi"),
                new(".dwf", "drawing/x-dwf"),
                new(".dwp", "application/octet-stream"),
                new(".dxr", "application/x-director"),
                new(".eml", "message/rfc822"),
                new(".emz", "application/octet-stream"),
                new(".eot", "application/octet-stream"),
                new(".eps", "application/postscript"),
                new(".etx", "text/x-setext"),
                new(".evy", "application/envoy"),
                new(".exe", "application/octet-stream"),
                new(".exe.config", "text/xml"),
                new(".fdf", "application/vnd.fdf"),
                new(".fif", "application/fractals"),
                new(".fla", "application/octet-stream"),
                new(".flr", "x-world/x-vrml"),
                new(".flv", "video/x-flv"),
                new(".gif", "image/gif"),
                new(".gtar", "application/x-gtar"),
                new(".gz", "application/x-gzip"),
                new(".h", "text/plain"),
                new(".hdf", "application/x-hdf"),
                new(".hdml", "text/x-hdml"),
                new(".hhc", "application/x-oleobject"),
                new(".hhk", "application/octet-stream"),
                new(".hhp", "application/octet-stream"),
                new(".hlp", "application/winhlp"),
                new(".hqx", "application/mac-binhex40"),
                new(".hta", "application/hta"),
                new(".htc", "text/x-component"),
                new(".htm", "text/html"),
                new(".html", "text/html"),
                new(".htt", "text/webviewhtml"),
                new(".hxt", "text/html"),
                new(".ico", "image/x-icon"),
                new(".ics", "application/octet-stream"),
                new(".ief", "image/ief"),
                new(".iii", "application/x-iphone"),
                new(".inf", "application/octet-stream"),
                new(".ins", "application/x-internet-signup"),
                new(".isp", "application/x-internet-signup"),
                new(".IVF", "video/x-ivf"),
                new(".jar", "application/java-archive"),
                new(".java", "application/octet-stream"),
                new(".jck", "application/liquidmotion"),
                new(".jcz", "application/liquidmotion"),
                new(".jfif", "image/pjpeg"),
                new(".jpb", "application/octet-stream"),
                new(".jpe", "image/jpeg"),
                new(".jpeg", "image/jpeg"),
                new(".jpg", "image/jpeg"),
                new(".js", "application/x-javascript"),
                new(".jsx", "text/jscript"),
                new(".latex", "application/x-latex"),
                new(".lit", "application/x-ms-reader"),
                new(".lpk", "application/octet-stream"),
                new(".lsf", "video/x-la-asf"),
                new(".lsx", "video/x-la-asf"),
                new(".lzh", "application/octet-stream"),
                new(".m13", "application/x-msmediaview"),
                new(".m14", "application/x-msmediaview"),
                new(".m1v", "video/mpeg"),
                new(".m3u", "audio/x-mpegurl"),
                new(".man", "application/x-troff-man"),
                new(".manifest", "application/x-ms-manifest"),
                new(".map", "text/plain"),
                new(".mdb", "application/x-msaccess"),
                new(".mdp", "application/octet-stream"),
                new(".me", "application/x-troff-me"),
                new(".mht", "message/rfc822"),
                new(".mhtml", "message/rfc822"),
                new(".mid", "audio/mid"),
                new(".midi", "audio/mid"),
                new(".mix", "application/octet-stream"),
                new(".mmf", "application/x-smaf"),
                new(".mno", "text/xml"),
                new(".mny", "application/x-msmoney"),
                new(".mov", "video/quicktime"),
                new(".movie", "video/x-sgi-movie"),
                new(".mp2", "video/mpeg"),
                new(".mp3", "audio/mpeg"),
                new(".mpa", "video/mpeg"),
                new(".mpe", "video/mpeg"),
                new(".mpeg", "video/mpeg"),
                new(".mpg", "video/mpeg"),
                new(".mpp", "application/vnd.ms-project"),
                new(".mpv2", "video/mpeg"),
                new(".ms", "application/x-troff-ms"),
                new(".msi", "application/octet-stream"),
                new(".mso", "application/octet-stream"),
                new(".mvb", "application/x-msmediaview"),
                new(".mvc", "application/x-miva-compiled"),
                new(".nc", "application/x-netcdf"),
                new(".nsc", "video/x-ms-asf"),
                new(".nws", "message/rfc822"),
                new(".ocx", "application/octet-stream"),
                new(".oda", "application/oda"),
                new(".odc", "text/x-ms-odc"),
                new(".ods", "application/oleobject"),
                new(".one", "application/onenote"),
                new(".onea", "application/onenote"),
                new(".onetoc", "application/onenote"),
                new(".onetoc2", "application/onenote"),
                new(".onetmp", "application/onenote"),
                new(".onepkg", "application/onenote"),
                new(".osdx", "application/opensearchdescription+xml"),
                new(".p10", "application/pkcs10"),
                new(".p12", "application/x-pkcs12"),
                new(".p7b", "application/x-pkcs7-certificates"),
                new(".p7c", "application/pkcs7-mime"),
                new(".p7m", "application/pkcs7-mime"),
                new(".p7r", "application/x-pkcs7-certreqresp"),
                new(".p7s", "application/pkcs7-signature"),
                new(".pbm", "image/x-portable-bitmap"),
                new(".pcx", "application/octet-stream"),
                new(".pcz", "application/octet-stream"),
                new(".pdf", "application/pdf"),
                new(".pfb", "application/octet-stream"),
                new(".pfm", "application/octet-stream"),
                new(".pfx", "application/x-pkcs12"),
                new(".pgm", "image/x-portable-graymap"),
                new(".pko", "application/vnd.ms-pki.pko"),
                new(".pma", "application/x-perfmon"),
                new(".pmc", "application/x-perfmon"),
                new(".pml", "application/x-perfmon"),
                new(".pmr", "application/x-perfmon"),
                new(".pmw", "application/x-perfmon"),
                new(".png", "image/png"),
                new(".pnm", "image/x-portable-anymap"),
                new(".pnz", "image/png"),
                new(".pot", "application/vnd.ms-powerpoint"),
                new(".potm", "application/vnd.ms-powerpoint.template.macroEnabled.12"),
                new(".potx", "application/vnd.openxmlformats-officedocument.presentationml.template"),
                new(".ppam", "application/vnd.ms-powerpoint.addin.macroEnabled.12"),
                new(".ppm", "image/x-portable-pixmap"),
                new(".pps", "application/vnd.ms-powerpoint"),
                new(".ppsm", "application/vnd.ms-powerpoint.slideshow.macroEnabled.12"),
                new(".ppsx", "application/vnd.openxmlformats-officedocument.presentationml.slideshow"),
                new(".ppt", "application/vnd.ms-powerpoint"),
                new(".pptm", "application/vnd.ms-powerpoint.presentation.macroEnabled.12"),
                new(".pptx", "application/vnd.openxmlformats-officedocument.presentationml.presentation"),
                new(".prf", "application/pics-rules"),
                new(".prm", "application/octet-stream"),
                new(".prx", "application/octet-stream"),
                new(".ps", "application/postscript"),
                new(".psd", "application/octet-stream"),
                new(".psm", "application/octet-stream"),
                new(".psp", "application/octet-stream"),
                new(".pub", "application/x-mspublisher"),
                new(".qt", "video/quicktime"),
                new(".qtl", "application/x-quicktimeplayer"),
                new(".qxd", "application/octet-stream"),
                new(".ra", "audio/x-pn-realaudio"),
                new(".ram", "audio/x-pn-realaudio"),
                new(".rar", "application/octet-stream"),
                new(".ras", "image/x-cmu-raster"),
                new(".rf", "image/vnd.rn-realflash"),
                new(".rgb", "image/x-rgb"),
                new(".rm", "application/vnd.rn-realmedia"),
                new(".rmi", "audio/mid"),
                new(".roff", "application/x-troff"),
                new(".rpm", "audio/x-pn-realaudio-plugin"),
                new(".rtf", "application/rtf"),
                new(".rtx", "text/richtext"),
                new(".scd", "application/x-msschedule"),
                new(".sct", "text/scriptlet"),
                new(".sea", "application/octet-stream"),
                new(".setpay", "application/set-payment-initiation"),
                new(".setreg", "application/set-registration-initiation"),
                new(".sgml", "text/sgml"),
                new(".sh", "application/x-sh"),
                new(".shar", "application/x-shar"),
                new(".sit", "application/x-stuffit"),
                new(".sldm", "application/vnd.ms-powerpoint.slide.macroEnabled.12"),
                new(".sldx", "application/vnd.openxmlformats-officedocument.presentationml.slide"),
                new(".smd", "audio/x-smd"),
                new(".smi", "application/octet-stream"),
                new(".smx", "audio/x-smd"),
                new(".smz", "audio/x-smd"),
                new(".snd", "audio/basic"),
                new(".snp", "application/octet-stream"),
                new(".spc", "application/x-pkcs7-certificates"),
                new(".spl", "application/futuresplash"),
                new(".src", "application/x-wais-source"),
                new(".ssm", "application/streamingmedia"),
                new(".sst", "application/vnd.ms-pki.certstore"),
                new(".stl", "application/vnd.ms-pki.stl"),
                new(".sv4cpio", "application/x-sv4cpio"),
                new(".sv4crc", "application/x-sv4crc"),
                new(".swf", "application/x-shockwave-flash"),
                new(".t", "application/x-troff"),
                new(".tar", "application/x-tar"),
                new(".tcl", "application/x-tcl"),
                new(".tex", "application/x-tex"),
                new(".texi", "application/x-texinfo"),
                new(".texinfo", "application/x-texinfo"),
                new(".tgz", "application/x-compressed"),
                new(".thmx", "application/vnd.ms-officetheme"),
                new(".thn", "application/octet-stream"),
                new(".tif", "image/tiff"),
                new(".tiff", "image/tiff"),
                new(".toc", "application/octet-stream"),
                new(".tr", "application/x-troff"),
                new(".trm", "application/x-msterminal"),
                new(".tsv", "text/tab-separated-values"),
                new(".ttf", "application/octet-stream"),
                new(".txt", "text/plain"),
                new(".u32", "application/octet-stream"),
                new(".uls", "text/iuls"),
                new(".ustar", "application/x-ustar"),
                new(".vbs", "text/vbscript"),
                new(".vcf", "text/x-vcard"),
                new(".vcs", "text/plain"),
                new(".vdx", "application/vnd.ms-visio.viewer"),
                new(".vml", "text/xml"),
                new(".vsd", "application/vnd.visio"),
                new(".vss", "application/vnd.visio"),
                new(".vst", "application/vnd.visio"),
                new(".vsto", "application/x-ms-vsto"),
                new(".vsw", "application/vnd.visio"),
                new(".vsx", "application/vnd.visio"),
                new(".vtx", "application/vnd.visio"),
                new(".wav", "audio/wav"),
                new(".wax", "audio/x-ms-wax"),
                new(".wbmp", "image/vnd.wap.wbmp"),
                new(".wcm", "application/vnd.ms-works"),
                new(".wdb", "application/vnd.ms-works"),
                new(".wks", "application/vnd.ms-works"),
                new(".wm", "video/x-ms-wm"),
                new(".wma", "audio/x-ms-wma"),
                new(".wmd", "application/x-ms-wmd"),
                new(".wmf", "application/x-msmetafile"),
                new(".wml", "text/vnd.wap.wml"),
                new(".wmlc", "application/vnd.wap.wmlc"),
                new(".wmls", "text/vnd.wap.wmlscript"),
                new(".wmlsc", "application/vnd.wap.wmlscriptc"),
                new(".wmp", "video/x-ms-wmp"),
                new(".wmv", "video/x-ms-wmv"),
                new(".wmx", "video/x-ms-wmx"),
                new(".wmz", "application/x-ms-wmz"),
                new(".wps", "application/vnd.ms-works"),
                new(".wri", "application/x-mswrite"),
                new(".wrl", "x-world/x-vrml"),
                new(".wrz", "x-world/x-vrml"),
                new(".wsdl", "text/xml"),
                new(".wvx", "video/x-ms-wvx"),
                new(".x", "application/directx"),
                new(".xaf", "x-world/x-vrml"),
                new(".xaml", "application/xaml+xml"),
                new(".xap", "application/x-silverlight-app"),
                new(".xbap", "application/x-ms-xbap"),
                new(".xbm", "image/x-xbitmap"),
                new(".xdr", "text/plain"),
                new(".xla", "application/vnd.ms-excel"),
                new(".xlam", "application/vnd.ms-excel.addin.macroEnabled.12"),
                new(".xlc", "application/vnd.ms-excel"),
                new(".xlm", "application/vnd.ms-excel"),
                new(".xls", "application/vnd.ms-excel"),
                new(".xlsb", "application/vnd.ms-excel.sheet.binary.macroEnabled.12"),
                new(".xlsm", "application/vnd.ms-excel.sheet.macroEnabled.12"),
                new(".xlsx", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),
                new(".xlt", "application/vnd.ms-excel"),
                new(".xltm", "application/vnd.ms-excel.template.macroEnabled.12"),
                new(".xltx", "application/vnd.openxmlformats-officedocument.spreadsheetml.template"),
                new(".xlw", "application/vnd.ms-excel"),
                new(".xml", "text/xml"),
                new(".xof", "x-world/x-vrml"),
                new(".xpm", "image/x-xpixmap"),
                new(".xps", "application/vnd.ms-xpsdocument"),
                new(".xsd", "text/xml"),
                new(".xsf", "text/xml"),
                new(".xsl", "text/xml"),
                new(".xslt", "text/xml"),
                new(".xsn", "application/octet-stream"),
                new(".xtp", "application/octet-stream"),
                new(".xwd", "image/x-xwindowdump"),
                new(".z", "application/x-compress"),
                new(".zip", "application/x-zip-compressed"),
            });
    }
}